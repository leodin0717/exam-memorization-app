<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>한국사 키워드 카드 생성 앱</title>
  <meta name="description" content="한국사 핵심 키워드 입력 기반 유사유형 카드 자동 생성·압축 인출 앱">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="bg-orbs"><div class="orb"></div><div class="orb"></div><div class="orb"></div></div>

  <header class="app-header">
    <div class="header-inner">
      <div class="header-logo"><span class="logo-icon">🏛️</span><span id="historyHeaderTitle">한국사 키워드 카드 생성</span></div>
      <div style="display:flex;align-items:center;gap:8px;">
        <label for="subjectSwitch" style="font-size:12px;color:var(--text-muted);font-weight:700;">과목</label>
        <select id="subjectSwitch" class="filter-select" style="padding:6px 10px;border-radius:10px;font-size:12px;font-weight:700;width:auto;">
          <option value="his" selected>한국사</option>
          <option value="law">행정법</option>
          <option value="admin">행정학</option>
          <option value="kor">국어</option>
          <option value="eng">영어</option>
        </select>
      </div>
      <a class="journal-link" id="journalLink" href="journal.html?subject=his">📒 학습기록</a>
      <div class="dday-badge" id="ddayBadge">D-0</div>
      <nav class="nav-tabs" id="navTabs">
        <button class="nav-tab active" data-page="dashboard">📊 대시보드</button>
        <button class="nav-tab" data-page="maker">🧩 카드생성</button>
        <button class="nav-tab" data-page="drill">⚡ 압축훈련</button>
        <button class="nav-tab" data-page="guide">📘 가이드</button>
      </nav>
    </div>
  </header>

  <main class="main-container">
    <div class="page active" id="page-dashboard">
      <div class="dash-grid">
        <div class="stat-card">
          <div class="stat-label">생성 카드</div>
          <div class="stat-value" id="statGenerated">0</div>
          <div class="stat-sub">최근 생성 세트 기준</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">정답률</div>
          <div class="stat-value" id="statAccuracy">--%</div>
          <div class="stat-sub">누적(카드훈련)</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">평균 반응</div>
          <div class="stat-value" id="statAvgSec">--.-s</div>
          <div class="stat-sub">선택까지 걸린 시간</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">오늘 풀이</div>
          <div class="stat-value" id="statToday">0</div>
          <div class="stat-sub">오늘 푼 카드</div>
        </div>
      </div>

      <div class="q-card" style="margin-top:12px;">
        <h3 style="font-size:15px;font-weight:800;margin-bottom:8px;">🎯 빠른 시작 키워드 (기출 시드 기반)</h3>
        <div class="chip-cloud" id="recommendedKeywords"></div>
        <div class="scope-note" style="margin-top:8px;">키워드를 누르면 카드생성 탭에 자동 입력됩니다.</div>
      </div>

      <div class="q-card" style="margin-top:12px;">
        <h3 style="font-size:15px;font-weight:800;margin-bottom:8px;">🔥 즉시 재압축 큐</h3>
        <div id="retryQueueSummary"></div>
        <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap;">
          <button class="btn btn-primary" id="startRetryDrill">오답·지연 카드 재훈련</button>
          <button class="btn btn-secondary" id="jumpToMaker">새 키워드 카드 생성</button>
        </div>
      </div>
    </div>

    <div class="page" id="page-maker">
      <div class="q-card">
        <h2 style="font-size:20px;font-weight:800;margin-bottom:16px;">🧩 키워드 카드 생성</h2>
        <div class="maker-grid">
          <div>
            <label class="maker-label" for="keywordInput">핵심 키워드</label>
            <textarea id="keywordInput" class="keyword-input" placeholder="예: 임진왜란, 병자호란"></textarea>
            <div class="scope-note">여러 개는 쉼표(,)로 입력. 1개만 입력해도 자동 생성됩니다.</div>
          </div>
          <div>
            <label class="maker-label" for="keywordMode">생성 유형</label>
            <select class="filter-select" id="keywordMode">
              <option value="auto">AUTO (추천 혼합)</option>
              <option value="after">이후/이전형</option>
              <option value="between">사이/연표형</option>
              <option value="sameEra">동시기형</option>
              <option value="cause">원인-결과형</option>
            </select>

            <label class="maker-label" for="cardFormat" style="margin-top:10px;">문항 형식</label>
            <select class="filter-select" id="cardFormat">
              <option value="mixed">혼합형 (추천)</option>
              <option value="mcq">통합형(4지선다)</option>
              <option value="ox">OX</option>
            </select>

            <label class="maker-label" for="cardCount" style="margin-top:10px;">카드 수</label>
            <select class="filter-select" id="cardCount">
              <option value="10">10장</option>
              <option value="20" selected>20장</option>
              <option value="30">30장</option>
            </select>
          </div>
        </div>

        <div class="filter-bar training-bar" style="margin-top:14px;">
          <span style="font-size:13px;font-weight:700;color:var(--text-muted);">훈련옵션:</span>
          <label class="training-option">
            <input type="checkbox" id="speedModeToggle">
            <span>⚡ 스피드모드 (자동 다음)</span>
          </label>
          <label class="training-option">
            <input type="checkbox" id="strictModeToggle" checked>
            <span>🎯 핵심중심(S/A 우선)</span>
          </label>
          <span class="scope-note">시간 부족 대비: 핵심 사건 반복 인출 우선</span>
        </div>

        <div style="margin-top:14px;display:flex;gap:8px;flex-wrap:wrap;">
          <button class="btn btn-primary" id="generateCardsBtn">카드 생성</button>
          <button class="btn btn-secondary" id="startDrillBtn" disabled>즉시 풀이 시작</button>
          <span class="q-counter" id="generatedSummary"></span>
        </div>
      </div>

      <div class="q-card" style="margin-top:12px;">
        <h3 style="font-size:15px;font-weight:800;margin-bottom:8px;">📚 생성 카드 미리보기</h3>
        <div id="generatedList" class="history-card-list"></div>
      </div>
    </div>

    <div class="page" id="page-drill">
      <div id="drillSetup">
        <div class="q-card">
          <h2 style="font-size:20px;font-weight:800;margin-bottom:12px;">⚡ 압축훈련</h2>
          <p style="color:var(--text-secondary);font-size:14px;line-height:1.45;">
            키워드 카드 생성 후 시작하세요. 틀리거나 오래 걸린 카드는 자동으로 재압축 큐에 들어갑니다.
          </p>
          <button class="btn btn-primary" id="goMakerFromDrill">카드생성으로 이동</button>
        </div>
      </div>

      <div id="drillArea" style="display:none;">
        <div class="pressure-rope" id="drillRopeTimer" hidden>
          <div class="pressure-head">
            <span class="pressure-label">🔥 압박 타임라인</span>
            <span class="pressure-time" id="drillRopeText">--.-초</span>
          </div>
          <div class="pressure-track">
            <div class="pressure-ropeline" id="drillRopeFill"></div>
            <div class="pressure-embers"></div>
            <div class="pressure-ropeburn" id="drillRopeBurn"></div>
          </div>
        </div>

        <div class="question-area" id="drillQuestion"></div>

        <div class="q-nav">
          <button class="btn btn-secondary" id="prevDrill">← 이전</button>
          <span class="q-counter" id="drillCounter">1 / 20</span>
          <button class="btn btn-primary" id="nextDrill">다음 →</button>
        </div>
      </div>

      <div id="drillResult" style="display:none;"></div>
    </div>

    <div class="page" id="page-guide">
      <h2 style="font-size:20px;font-weight:800;margin-bottom:20px;">📘 한국사 압축 가이드</h2>
      <div id="guideContent"></div>
    </div>
  </main>

  <script src="history-data.js"></script>
  <script src="history-data-supplement.js"></script>
  <script src="study-journal.js"></script>
  <script src="history-app.js"></script>
</body>
</html>
